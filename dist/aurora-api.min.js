!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.AuroraAPI=o():e.AuroraAPI=o()}(self,(function(){return(()=>{var e={792:(e,o,t)=>{var r=null;"undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof MozWebSocket?r=MozWebSocket:void 0!==t.g?r=t.g.WebSocket||t.g.MozWebSocket:"undefined"!=typeof window?r=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),e.exports=r}},o={};function t(r){var n=o[r];if(void 0!==n)return n.exports;var s=o[r]={exports:{}};return e[r](s,s.exports,t),s.exports}t.d=(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o);var r={};return(()=>{"use strict";t.d(r,{AuroraAPI:()=>l});var e,o=t(792),n=new Uint8Array(16);function s(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&i.test(e)};for(var c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));const d=function(e,o,t){var r=(e=e||{}).random||(e.rng||s)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,o){t=t||0;for(var n=0;n<16;++n)o[t+n]=r[n];return o}return function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(c[e[o+0]]+c[e[o+1]]+c[e[o+2]]+c[e[o+3]]+"-"+c[e[o+4]]+c[e[o+5]]+"-"+c[e[o+6]]+c[e[o+7]]+"-"+c[e[o+8]]+c[e[o+9]]+"-"+c[e[o+10]]+c[e[o+11]]+c[e[o+12]]+c[e[o+13]]+c[e[o+14]]+c[e[o+15]]).toLowerCase();if(!a(t))throw TypeError("Stringified UUID is invalid");return t}(r)};class f{constructor(){this.listeners=new Map}addListener(e,o){this.listeners.set(e,o)}emit(e){return void 0===e.uuid?console.error("[AuroraAPI] Broken request: ",e):this.listeners.has(e.uuid)?(this.listeners.get(e.uuid)(e),void this.listeners.delete(e.uuid)):console.error("[AuroraAPI] Unhandled request: ",e)}}class l{constructor(e,t){this._messageEmitter=new f,this._ready=()=>{console.error("[AuroraAPI] If you see this message, tell the developer of the `aurora-api` library that he is the creator of the crutches.")},this._socket=new o(e),this._socket.onclose=e=>this.onClose(e,t?.onClose),this._socket.onerror=e=>this.onError(e,t?.onError),this._socket.onmessage=e=>this.onMessage(e,t?.onMessage),this._socket.onopen=e=>this.onOpen(e,t?.onOpen)}close(e,o){this._socket.close(e,o)}hasConnected(){return this._socket.readyState===this._socket.OPEN}async ready(){return!!this.hasConnected()||await new Promise((e=>{this._ready=()=>{e(!0)}}))}send(e,o={},t){if(!this.hasConnected())return console.error("[AuroraAPI] WebSocket not connected");const r=d();if(this._socket.send(JSON.stringify({type:e,uuid:r,data:o})),void 0===t)return new Promise(((e,o)=>{this._messageEmitter.addListener(r,(t=>{void 0!==t.code?o(t):e(t)}))}));this._messageEmitter.addListener(r,(e=>{void 0!==e.code?t(e):t(null,e)}))}onOpen(e,o){console.log("[AuroraAPI] Connection established"),this._ready(),o&&o(e)}onClose(e,o){if(e.wasClean)return console.log("[AuroraAPI] Connection closed");1006===e.code?console.error("[AuroraAPI] Break connection"):console.error("[AuroraAPI] Unknown error",e),o&&o(e)}onMessage(e,o){this._messageEmitter.emit(JSON.parse(e.data)),o&&o(e)}onError(e,o){console.error("[AuroraAPI] WebSocket error observed:",e),o&&o(e)}}})(),r.AuroraAPI})()}));
//# sourceMappingURL=aurora-api.min.js.map