{
  "version": 3,
  "sources": ["../src/classes/APIError.ts", "../src/classes/AuroraAPI.ts", "../node_modules/modern-isomorphic-ws/browser.js", "../node_modules/uuid/dist/esm-browser/rng.js", "../node_modules/uuid/dist/esm-browser/regex.js", "../node_modules/uuid/dist/esm-browser/validate.js", "../node_modules/uuid/dist/esm-browser/stringify.js", "../node_modules/uuid/dist/esm-browser/v4.js", "../src/classes/MessageEmitter.ts", "../src/classes/AuroraAPISocket.ts"],
  "sourcesContent": ["export class APIError extends Error {\r\n    private code: number\r\n\r\n    constructor(code?: number, message?: string) {\r\n        super(message || \"Unknown response error\")\r\n        this.code = code || 0\r\n        this.name = this.constructor.name\r\n    }\r\n\r\n    toObject() {\r\n        return {\r\n            code: this.code,\r\n            message: this.message,\r\n        }\r\n    }\r\n\r\n    // \u0418\u043C\u0435\u0435\u0442 \u043B\u0438 \u0441\u043C\u044B\u0441\u043B?\r\n    toJson() {\r\n        return JSON.stringify(this.toObject())\r\n    }\r\n}\r\n", "import { ResponseData } from \"../types/Response\"\r\nimport { AuthResponseData } from \"../types/response/AuthResponse\"\r\nimport { ProfileResponseData } from \"../types/response/ProfileResponse\"\r\nimport { ServersResponseData } from \"../types/response/ServersResponse\"\r\nimport { UpdatesResponseData } from \"../types/response/UpdatesResponse\"\r\nimport { APIError } from \"./APIError\"\r\nimport { AuroraAPISocket, ResponseError } from \"..\"\r\n\r\nexport class AuroraAPI {\r\n    apiInstance: AuroraAPISocket\r\n\r\n    constructor(url: string) {\r\n        this.apiInstance = new AuroraAPISocket(url)\r\n    }\r\n\r\n    public async auth(login: string, password: string) {\r\n        return <AuthResponseData>await this.getRequest(\"auth\", { login, password })\r\n    }\r\n\r\n    public async getServers() {\r\n        return <ServersResponseData>await this.getRequest(\"servers\")\r\n    }\r\n\r\n    public async getProfile(uuid: string) {\r\n        return <ProfileResponseData>await this.getRequest(\"profile\", { uuid })\r\n    }\r\n\r\n    public async getUpdates(dir: string) {\r\n        return <UpdatesResponseData>await this.getRequest(\"updates\", { dir })\r\n    }\r\n\r\n    private async getRequest<T extends ResponseData>(method: string, payload?: any): Promise<T> {\r\n        try {\r\n            const { data } = await this.apiInstance.send(method, payload)\r\n            return <T>data\r\n        } catch (error) {\r\n            const { code, message } = <ResponseError>error\r\n            throw new APIError(code, message)\r\n        }\r\n    }\r\n}\r\n", "export default WebSocket;\n", "// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}", "export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;", "import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;", "import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;", "import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;", "import { Response, ResponseError, ResponseEvent } from \"../types/Response\"\n\nexport default class MessageEmitter {\n    listeners: Map<string, ResponseEvent> = new Map()\n\n    public addListener(uuid: string, listener: ResponseEvent) {\n        this.listeners.set(uuid, listener)\n    }\n\n    public emit(data: Response | ResponseError) {\n        if (data.uuid === undefined) return console.error(\"[AuroraAPI] Broken request: \", data)\n        if (!this.listeners.has(data.uuid)) return console.error(\"[AuroraAPI] Unhandled request: \", data)\n\n        this.listeners.get(data.uuid)!(data)\n        this.listeners.delete(data.uuid)\n    }\n}\n", "import WebSocket from \"modern-isomorphic-ws\"\r\nimport { v4 as uuidv4 } from \"uuid\"\r\n\r\nimport { Response, ResponseError } from \"../types/Response\"\r\nimport { APIError } from \"./APIError\"\r\nimport MessageEmitter from \"./MessageEmitter\"\r\n\r\n// \u041C\u043E\u0436\u043D\u043E \u0440\u0430\u0441\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u0438\u0432\u0430\u0442\u043D\u044B\u0445 \u043F\u043E\u043B\u0435\u0439 \u0447\u0435\u0440\u0435\u0437 #\r\n// https://github.com/tc39/proposal-class-fields/blob/master/PRIVATE_SYNTAX_FAQ.md\r\n// \u0423 \u0432\u0435\u0431\u043F\u0430\u043A\u0430 \u0435\u0441\u0442\u044C \u0441\u0432\u043E\u0438 \u043F\u0440\u0438\u043A\u043E\u043B\u044B \u043D\u0430 \u044D\u0442\u043E\u0442 \u0441\u0447\u0451\u0442, \u043C\u0431 \u0437\u0430\u043C\u0435\u043D\u0438\u0442\u044C \u0435\u0433\u043E \u043A \u0447\u0451\u0440\u0442\u0443?))\r\n// + logger settings\r\n\r\nexport class AuroraAPISocket {\r\n    private _messageEmitter = new MessageEmitter()\r\n    private _socket: WebSocket\r\n    private _ready = () => {\r\n        console.error(\r\n            \"[AuroraAPI] If you see this message, tell the developer of the `aurora-api` library that he is the creator of the crutches.\"\r\n        )\r\n    }\r\n\r\n    constructor(\r\n        url: string,\r\n        events?: {\r\n            onClose?: (event: WebSocket.CloseEvent | CloseEvent) => void\r\n            onError?: (event: WebSocket.ErrorEvent | Event) => void\r\n            onMessage?: (event: WebSocket.MessageEvent | MessageEvent) => void\r\n            onOpen?: (event: WebSocket.Event | Event) => void\r\n        }\r\n    ) {\r\n        this._socket = new WebSocket(url)\r\n        this._socket.onclose = (event) => this.onClose(event, events?.onClose)\r\n        this._socket.onerror = (event) => this.onError(event, events?.onError)\r\n        this._socket.onmessage = (event) => this.onMessage(event, events?.onMessage)\r\n        this._socket.onopen = (event) => this.onOpen(event, events?.onOpen)\r\n    }\r\n\r\n    // reopen?\r\n    public close(code?: number, data?: string): void {\r\n        this._socket.close(code, data)\r\n    }\r\n\r\n    public hasConnected(): boolean {\r\n        return this._socket.readyState === this._socket.OPEN\r\n    }\r\n\r\n    public async ready() {\r\n        if (this.hasConnected()) return true\r\n        return await new Promise((resolve) => {\r\n            this._ready = () => {\r\n                resolve(true)\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * \u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430 \u0437\u0430\u043F\u0440\u043E\u0441\u0430\r\n     * @param type \u0422\u0438\u043F \u0440\u0435\u043A\u0432\u0435\u0441\u0442\u0430\r\n     * @param data \u0414\u0430\u043D\u043D\u044B\u0435\r\n     * @throws {ResponseError}\r\n     */\r\n    public send(type: string, data: object = {}): Promise<Response> {\r\n        if (!this.hasConnected()) throw new APIError(90, \"[AuroraAPI] WebSocket not connected\")\r\n\r\n        const uuid = uuidv4()\r\n        this._socket.send(JSON.stringify({ type, uuid, data }))\r\n\r\n        return new Promise((resolve, reject) => {\r\n            this._messageEmitter.addListener(uuid, (data: Response | ResponseError): void => {\r\n                if ((<ResponseError>data).code !== undefined) reject(data)\r\n                else resolve(<Response>data)\r\n            })\r\n        })\r\n    }\r\n\r\n    /* Events */\r\n\r\n    private onOpen(event: WebSocket.Event | Event, eventListener?: (event: WebSocket.Event | Event) => void): void {\r\n        this._ready()\r\n        console.log(\"[AuroraAPI] Connection established\")\r\n        if (eventListener) eventListener(event)\r\n    }\r\n\r\n    private onClose(\r\n        event: WebSocket.CloseEvent | CloseEvent,\r\n        eventListener?: (event: WebSocket.CloseEvent | CloseEvent) => void\r\n    ) {\r\n        if (event.wasClean) return console.log(\"[AuroraAPI] Connection closed\")\r\n        if (event.code === 1006) console.error(\"[AuroraAPI] Break connection\")\r\n        else console.error(\"[AuroraAPI] Unknown error\", event)\r\n        if (eventListener) eventListener(event)\r\n    }\r\n\r\n    private onMessage(\r\n        event: WebSocket.MessageEvent | MessageEvent,\r\n        eventListener?: (event: WebSocket.MessageEvent | MessageEvent) => void\r\n    ) {\r\n        this._messageEmitter.emit(JSON.parse(event.data))\r\n        if (eventListener) eventListener(event)\r\n    }\r\n\r\n    private onError(\r\n        event: WebSocket.ErrorEvent | Event,\r\n        eventListener?: (event: WebSocket.ErrorEvent | Event) => void\r\n    ) {\r\n        console.error(\"[AuroraAPI] WebSocket error observed:\", event)\r\n        if (eventListener) eventListener(event)\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
